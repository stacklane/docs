<!--TEMPLATE mustache-->

{{% yaml /_nav/menu-items as items }}
{{% svg /_icons/ as icon }}

<div id="sidebar" class="sidebar"> {{! is-invisible -- this is problematic for layout responsiveness.. }}
<h1 class="nav-category">Development</h1>
<ul>
    {{# items.overview }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.overview }}
</ul>

<h1 class="nav-category">Settings</h1>
<ul>
    {{# items.settings }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.settings }}
</ul>
<h1 class="nav-category">Models</h1>
<ul>
    {{# items.models }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.models }}
</ul>
<h1 class="nav-category">Endpoints</h1>
<ul>
    {{# items.endpoints }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.endpoints }}
</ul>
<h1 class="nav-category">Scripting</h1>
<ul>
    {{# items.scripting }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.scripting }}
</ul>
<h1 class="nav-category">Users</h1>
<ul>
    {{# items.users }}
    <li><a class="nav-link" href="/{{path}}">{{title}}</a></li>
    {{/ items.users }}
</ul>

<div class="nav-separator"></div>

<a class="nav-link level" href="/examples">
    <div class="level-left">
        <div class="level-item"><span class="icon is-small">{{> icon-slideshow }}</span></div>
        <div class="level-item">Examples</div>
    </div>
</a>

<a class="nav-link level" href="/integrations">
    <div class="level-left">
        <div class="level-item"><span class="icon is-small">{{> icon-extension }}</span></div>
        <div class="level-item">Integrations</div>
    </div>
</a>

<a class="nav-link level" href="/releases">
    <div class="level-left">
        <div class="level-item"><span class="icon is-small">{{> icon-list_alt }}</span></div>
        <div class="level-item">Release Notes</div>
    </div>
</a>

<a class="nav-link level" href="https://stacklane.com/guide/">
    <div class="level-left">
        <div class="level-item"><span class="icon is-small">{{> icon-map }}</span></div>
        <div class="level-item">Evaluation Guide</div>
    </div>
</a>

</div>

{{! At earliest moment, select the current nav link, and enable category expansion. }}
<script>
    $each('.nav-link', function(e){
        if (e.getAttribute('href') == window.location.pathname){
            e.classList.add('is-active');
            var ul = e.parentElement.parentElement;
            ul.classList.toggle('is-active', true);
            if (ul.previousElementSibling)
                ul.previousElementSibling.classList.toggle('is-active', true);
        }
    });

    /**
     * This technique produces the least amount of 'flashing',
     * since there is nothing at all shown until navs are ready
     */
    //$get('sidebar').classList.remove('is-invisible');

    $on('.nav-category', 'click', function(event){
        var cat = $up(event.target, '.nav-category');
        cat.classList.toggle('is-active');
        cat.nextElementSibling.classList.toggle('is-active');
    });
</script>