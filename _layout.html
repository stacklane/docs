<!--TEMPLATE mustache-->
<!DOCTYPE html>
<html>
<head>
    <title>{{$title}}Docs{{/title}} | Stacklane Docs</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="/style/theme.scss">

    <script src="https://cdn.jsdelivr.net/npm/smooth-scroll@12.1.5/dist/js/smooth-scroll.min.js" integrity="sha256-MMt0/21G3z0Zg4ET1kI3HC9npItDowkitRDVr0FhCxA=" crossorigin="anonymous"></script>

    {{! PrismJS }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/themes/prism.css" integrity="sha256-/Kfdz9pXGPe+bFF+TtxHqbg6F9c3Rb0jN48uy+2b/do=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/plugins/line-highlight/prism-line-highlight.css" integrity="sha256-kjW5Ys+ilGALW4tSnWeX73qpacEG2ZXswXV98dLNNRI=" crossorigin="anonymous">
    <script defer async src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/prism.js" integrity="sha256-epniwOZCSYGoGeC9Db9iF5ZNe1GGtWkJOx9QsjgGG1s=" crossorigin="anonymous"></script>
    <script defer async src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/components/prism-yaml.min.js" integrity="sha256-pxsoS7PqPuy6D5T0Dq2PEXKJ5SRlIkdG8hpoMxQ0YlM=" crossorigin="anonymous"></script>
    <script defer async src="https://cdn.jsdelivr.net/npm/prismjs@1.15.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha256-DEl9ZQE+lseY13oqm2+mlUr+sVI18LG813P+kzzIm8o=" crossorigin="anonymous"></script>

    {{! Small, inline DOM utils }}
    <script src="/_dom.js"></script>

    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />

    {{! Imports }}
    {{% svg /_logos/ as logo }}
    {{% svg /icons/ as icon }}
</head>
<body>
<nav id="nav" class="navbar is-spaced is-fixed-top" role="navigation" aria-label="main navigation">
    <div class="container">
    <div class="navbar-brand">
        <a href="https://stacklane.com" class="navbar-item logo">{{>logo-sl_full}}</a>
        <a href="/" title="Docs" class="navbar-item">Docs</a>
        <span class="navbar-item navbar-title">{{$title}}{{/title}}</span>
    </div>

    <div class="navbar-menu">
        <div class="navbar-start">

        </div>

        <div class="navbar-end">
            <!-- TODO csp work, OR, create a 'connector' -->
            <a href="https://stacklane.com/status/" id="status" class="navbar-item up is-invisible">
                <span id="status-indicator"></span>
                <span id="status-text"></span>
            </a>
        </div>
    </div>
    </div>
</nav>

<main role="main">
    <div class="container">
        {{$content}}Content{{/content}}
    </div>
</main>

<footer class="container">
    &copy; Stacklane, Inc. {{ðŸŽ¨.startYear}}-{{ðŸŽ¨.year}}. All rights reserved.
</footer>

<script>
    /** Add a body class when scrolled past the fixed nav bar height. */
    window.addEventListener('scroll', function(){
        var st = (document.documentElement && document.documentElement.scrollTop) || document.body.scrollTop;
        var past = st > $get('nav').getBoundingClientRect().height;
        document.body.classList.toggle('is-scrolled', past);
    });

    $ready(function() {
        var height = $get('nav').getBoundingClientRect().height;
        if (typeof SmoothScroll !== 'undefined') new SmoothScroll('[data-scroll]', {
            /** Related to CSS involved with handling h1:target anchors from direct links */
            offset: height - 40
        });
    });

    $ready(function(){
        var moreClass = 'is-invisible '; // TODO needs csp work or a connector
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/status/api/status'); // assumes docs are mounted on same domain as /status/

        xhr.onreadystatechange = function () {
            var DONE = 4; // readyState 4 means the request is done.
            var OK = 200; // status 200 is a successful return.
            if (xhr.readyState === DONE) {
                if (xhr.status === OK) {

                    var r = JSON.parse(xhr.responseText);

                    document.getElementById('status').setAttribute('class', moreClass + r.status);
                    document.getElementById('status').setAttribute('title', new Date().toLocaleString());

                } else {
                    document.getElementById('status').setAttribute('class', moreClass + 'error');
                }
            } else {
                document.getElementById('status').setAttribute('class', moreClass + 'error');
                console.log('Error: ' + xhr.status); // An error occurred during the request.
            }
        };

        xhr.send(null);
    });
</script>
</body>
</html>